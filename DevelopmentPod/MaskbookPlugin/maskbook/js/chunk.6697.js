"use strict";
(globalThis["webpackChunk_masknet_extension"] = globalThis["webpackChunk_masknet_extension"] || []).push([[6697],{

/***/ 26691:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Y": () => (/* binding */ CheckedIcon)
/* harmony export */ });
/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(74750);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(44438);


const CheckedIcon = (0,_utils__WEBPACK_IMPORTED_MODULE_1__/* .createIcon */ .I)('CheckedIcon', /*#__PURE__*/ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("g", {
    children: [
        /*#__PURE__*/ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("path", {
            d: "M0 4C0 1.79086 1.79086 0 4 0H14C16.2091 0 18 1.79086 18 4V14C18 16.2091 16.2091 18 14 18H4C1.79086 18 0 16.2091 0 14V4Z",
            fill: "#1C68F3"
        }),
        /*#__PURE__*/ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M14.0303 5.46967C14.3232 5.76256 14.3232 6.23744 14.0303 6.53033L8.03033 12.5303C7.73744 12.8232 7.26256 12.8232 6.96967 12.5303L3.96967 9.53033C3.67678 9.23744 3.67678 8.76256 3.96967 8.46967C4.26256 8.17678 4.73744 8.17678 5.03033 8.46967L7.5 10.9393L12.9697 5.46967C13.2626 5.17678 13.7374 5.17678 14.0303 5.46967Z",
            fill: "#FCFCFD"
        })
    ]
}), '0 0 18 18');


/***/ }),

/***/ 15259:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "G": () => (/* binding */ CheckedBorderIcon)
/* harmony export */ });
/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(74750);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(44438);


const CheckedBorderIcon = (0,_utils__WEBPACK_IMPORTED_MODULE_1__/* .createIcon */ .I)('CheckedBorderIcon', /*#__PURE__*/ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("g", {
    children: /*#__PURE__*/ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("rect", {
        x: "0.5",
        y: "0.5",
        width: "17",
        height: "17",
        rx: "3.5",
        fill: "white"
    })
}), '0 0 18 18');


/***/ }),

/***/ 76697:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ Wallet_AddDeriveWallet)
});

// EXTERNAL MODULE: ../../node_modules/.pnpm/react@18.0.0-rc.0/node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(74750);
// EXTERNAL MODULE: ../../node_modules/.pnpm/react@18.0.0-rc.0/node_modules/react/index.js
var react = __webpack_require__(76342);
// EXTERNAL MODULE: ../../node_modules/.pnpm/react-router@5.2.1_react@18.0.0-rc.0/node_modules/react-router/esm/react-router.js
var react_router = __webpack_require__(22749);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+material@5.4.2_859545d82eec4e4ab7d574641ee2c82e/node_modules/@mui/material/Typography/Typography.js + 1 modules
var Typography = __webpack_require__(67020);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+material@5.4.2_859545d82eec4e4ab7d574641ee2c82e/node_modules/@mui/material/TableContainer/TableContainer.js
var TableContainer = __webpack_require__(9328);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+material@5.4.2_859545d82eec4e4ab7d574641ee2c82e/node_modules/@mui/material/TablePagination/TablePagination.js
var TablePagination = __webpack_require__(85589);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+material@5.4.2_859545d82eec4e4ab7d574641ee2c82e/node_modules/@mui/material/TablePagination/tablePaginationClasses.js
var tablePaginationClasses = __webpack_require__(17510);
// EXTERNAL MODULE: ../theme/src/index.ts + 2 modules
var src = __webpack_require__(42421);
// EXTERNAL MODULE: ./src/extension/popups/components/NetworkSelector/index.tsx
var NetworkSelector = __webpack_require__(68484);
// EXTERNAL MODULE: ../plugins/Wallet/src/index.ts
var Wallet_src = __webpack_require__(26218);
// EXTERNAL MODULE: ../../node_modules/.pnpm/react-use@17.3.2_757a802188413a36d4f24237d13b8e90/node_modules/react-use/esm/useAsync.js
var useAsync = __webpack_require__(59302);
// EXTERNAL MODULE: ../../node_modules/.pnpm/react-use@17.3.2_757a802188413a36d4f24237d13b8e90/node_modules/react-use/esm/useAsyncFn.js
var useAsyncFn = __webpack_require__(56838);
// EXTERNAL MODULE: ./src/plugins/Wallet/messages.ts
var messages = __webpack_require__(70202);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+material@5.4.2_859545d82eec4e4ab7d574641ee2c82e/node_modules/@mui/material/Table/Table.js
var Table = __webpack_require__(36347);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+material@5.4.2_859545d82eec4e4ab7d574641ee2c82e/node_modules/@mui/material/TableHead/TableHead.js
var TableHead = __webpack_require__(64109);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+material@5.4.2_859545d82eec4e4ab7d574641ee2c82e/node_modules/@mui/material/TableRow/TableRow.js + 1 modules
var TableRow = __webpack_require__(50440);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+material@5.4.2_859545d82eec4e4ab7d574641ee2c82e/node_modules/@mui/material/TableCell/TableCell.js + 1 modules
var TableCell = __webpack_require__(80689);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+material@5.4.2_859545d82eec4e4ab7d574641ee2c82e/node_modules/@mui/material/TableBody/TableBody.js
var TableBody = __webpack_require__(33576);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+material@5.4.2_859545d82eec4e4ab7d574641ee2c82e/node_modules/@mui/material/Skeleton/Skeleton.js + 1 modules
var Skeleton = __webpack_require__(7708);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+material@5.4.2_859545d82eec4e4ab7d574641ee2c82e/node_modules/@mui/material/CircularProgress/CircularProgress.js
var CircularProgress = __webpack_require__(91719);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+material@5.4.2_859545d82eec4e4ab7d574641ee2c82e/node_modules/@mui/material/Checkbox/Checkbox.js + 4 modules
var Checkbox = __webpack_require__(36122);
// EXTERNAL MODULE: ../shared/src/index.ts
var shared_src = __webpack_require__(78037);
// EXTERNAL MODULE: ../icons/general/CheckboxBorder.tsx
var CheckboxBorder = __webpack_require__(15259);
// EXTERNAL MODULE: ../icons/general/Checkbox.tsx
var general_Checkbox = __webpack_require__(26691);
// EXTERNAL MODULE: ../web3-shared/evm/hooks/useWeb3.ts + 1 modules
var useWeb3 = __webpack_require__(17869);
// EXTERNAL MODULE: ../web3-shared/evm/utils/formatter.ts
var formatter = __webpack_require__(71831);
// EXTERNAL MODULE: ./src/utils/index.ts + 5 modules
var utils = __webpack_require__(7282);
;// CONCATENATED MODULE: ./src/extension/popups/pages/Wallet/components/DeriveWalletTable/index.tsx









const useStyles = (0,src/* makeStyles */.ZL)()({
    header: {
        backgroundColor: '#F7F9FA',
        padding: '14px 0',
        borderBottom: 'none'
    },
    title: {
        fontSize: 12,
        lineHeight: '16px',
        fontWeight: 500
    },
    cell: {
        padding: '8px 0',
        borderBottom: 'none'
    },
    button: {
        fontWeight: 600,
        minWidth: 0,
        padding: '0 5px'
    }
});
const DeriveWalletTable = /*#__PURE__*/ (0,react.memo)(({ loading , dataSource , onCheck , confirmLoading  })=>{
    const { classes  } = useStyles();
    const { t  } = (0,utils/* useI18N */.M1)();
    return(/*#__PURE__*/ (0,jsx_runtime.jsxs)(Table/* default */.Z, {
        size: "small",
        padding: "none",
        stickyHeader: true,
        children: [
            /*#__PURE__*/ (0,jsx_runtime.jsx)(TableHead/* default */.Z, {
                children: /*#__PURE__*/ (0,jsx_runtime.jsxs)(TableRow/* default */.Z, {
                    children: [
                        /*#__PURE__*/ (0,jsx_runtime.jsx)(TableCell/* default */.Z, {
                            align: "center",
                            variant: "head",
                            className: classes.header,
                            children: /*#__PURE__*/ (0,jsx_runtime.jsx)(Typography/* default */.Z, {
                                className: classes.title,
                                children: t('address')
                            })
                        }, "address"),
                        /*#__PURE__*/ (0,jsx_runtime.jsx)(TableCell/* default */.Z, {
                            align: "center",
                            variant: "head",
                            className: classes.header,
                            children: /*#__PURE__*/ (0,jsx_runtime.jsx)(Typography/* default */.Z, {
                                className: classes.title,
                                children: t('wallet_balance_eth')
                            })
                        }, "balance"),
                        /*#__PURE__*/ (0,jsx_runtime.jsx)(TableCell/* default */.Z, {
                            align: "center",
                            variant: "head",
                            className: classes.header,
                            children: /*#__PURE__*/ (0,jsx_runtime.jsx)(Typography/* default */.Z, {
                                className: classes.title,
                                children: t('operation')
                            })
                        }, "Operation")
                    ]
                })
            }),
            /*#__PURE__*/ (0,jsx_runtime.jsx)(TableBody/* default */.Z, {
                children: (dataSource === null || dataSource === void 0 ? void 0 : dataSource.length) && !loading ? dataSource.map((item, index)=>/*#__PURE__*/ (0,jsx_runtime.jsx)(DeriveWalletTableRow, {
                        address: item.address,
                        selected: item.selected,
                        added: item.added,
                        onCheck: (checked)=>onCheck(checked, index)
                        ,
                        confirmLoading: confirmLoading
                    }, index)
                ) : Array.from({
                    length: 10
                }).fill(0).map((_, index)=>/*#__PURE__*/ (0,jsx_runtime.jsxs)(TableRow/* default */.Z, {
                        children: [
                            /*#__PURE__*/ (0,jsx_runtime.jsx)(TableCell/* default */.Z, {
                                align: "center",
                                variant: "body",
                                className: classes.cell,
                                children: /*#__PURE__*/ (0,jsx_runtime.jsx)(Skeleton/* default */.Z, {
                                    animation: "wave",
                                    variant: "rectangular",
                                    width: "90%",
                                    height: 24
                                })
                            }),
                            /*#__PURE__*/ (0,jsx_runtime.jsx)(TableCell/* default */.Z, {
                                align: "center",
                                variant: "body",
                                className: classes.cell,
                                children: /*#__PURE__*/ (0,jsx_runtime.jsx)(Skeleton/* default */.Z, {
                                    animation: "wave",
                                    variant: "rectangular",
                                    width: "90%",
                                    height: 24
                                })
                            }),
                            /*#__PURE__*/ (0,jsx_runtime.jsx)(TableCell/* default */.Z, {
                                align: "center",
                                variant: "body",
                                className: classes.cell,
                                children: /*#__PURE__*/ (0,jsx_runtime.jsx)(Skeleton/* default */.Z, {
                                    animation: "wave",
                                    variant: "rectangular",
                                    width: "90%",
                                    height: 24
                                })
                            })
                        ]
                    }, index)
                )
            })
        ]
    }));
});
const DeriveWalletTableRow = /*#__PURE__*/ (0,react.memo)(({ address , added , onCheck , selected  })=>{
    const { classes  } = useStyles();
    const web3 = (0,useWeb3/* useWeb3 */.$)();
    const { loading , value: balance  } = (0,useAsync/* default */.Z)(async ()=>web3.eth.getBalance(address)
    , [
        web3,
        address
    ]);
    return(/*#__PURE__*/ (0,jsx_runtime.jsxs)(TableRow/* default */.Z, {
        children: [
            /*#__PURE__*/ (0,jsx_runtime.jsx)(TableCell/* default */.Z, {
                align: "center",
                variant: "body",
                className: classes.cell,
                children: /*#__PURE__*/ (0,jsx_runtime.jsx)(Typography/* default */.Z, {
                    className: classes.title,
                    children: /*#__PURE__*/ (0,jsx_runtime.jsx)(shared_src/* FormattedAddress */.Kv, {
                        address: address,
                        size: 4,
                        formatter: formatter/* formatEthereumAddress */.j8
                    })
                })
            }),
            /*#__PURE__*/ (0,jsx_runtime.jsx)(TableCell/* default */.Z, {
                align: "center",
                variant: "body",
                className: classes.cell,
                children: loading ? /*#__PURE__*/ (0,jsx_runtime.jsx)(CircularProgress/* default */.Z, {
                    sx: {
                        color: '#15181B'
                    },
                    size: 12
                }) : /*#__PURE__*/ (0,jsx_runtime.jsx)(Typography/* default */.Z, {
                    className: classes.title,
                    children: /*#__PURE__*/ (0,jsx_runtime.jsx)(shared_src/* FormattedBalance */.BV, {
                        value: balance,
                        decimals: 18,
                        significant: 4,
                        symbol: "ETH",
                        formatter: formatter/* formatBalance */.az
                    })
                })
            }),
            /*#__PURE__*/ (0,jsx_runtime.jsx)(TableCell/* default */.Z, {
                align: "center",
                variant: "body",
                className: classes.cell,
                children: /*#__PURE__*/ (0,jsx_runtime.jsx)(Checkbox/* default */.Z, {
                    disabled: added,
                    defaultChecked: selected || added,
                    icon: /*#__PURE__*/ (0,jsx_runtime.jsx)(CheckboxBorder/* CheckedBorderIcon */.G, {
                        sx: {
                            fontSize: '16px',
                            stroke: '#1C68F3'
                        }
                    }),
                    checkedIcon: /*#__PURE__*/ (0,jsx_runtime.jsx)(general_Checkbox/* CheckedIcon */.Y, {
                        sx: {
                            fontSize: '16px'
                        }
                    }),
                    sx: {
                        color: '#1C68F3',
                        padding: 0,
                        width: 16,
                        height: 16,
                        borderRadius: 1,
                        '&.Mui-checked': {
                            color: '#1C68F3'
                        }
                    },
                    onChange: (e)=>onCheck(e.target.checked)
                })
            })
        ]
    }, address));
});

// EXTERNAL MODULE: ../web3-shared/evm/hooks/useWallets.ts
var useWallets = __webpack_require__(4521);
// EXTERNAL MODULE: ../web3-shared/evm/types/index.ts
var types = __webpack_require__(18249);
// EXTERNAL MODULE: ../web3-shared/evm/utils/address.ts
var address = __webpack_require__(77031);
// EXTERNAL MODULE: ../../node_modules/.pnpm/@mui+lab@5.0.0-alpha.69_23308786108cc798013b43ce7f4478a4/node_modules/@mui/lab/LoadingButton/LoadingButton.js + 1 modules
var LoadingButton = __webpack_require__(67943);
// EXTERNAL MODULE: ../shared-base/src/index.ts
var shared_base_src = __webpack_require__(86716);
// EXTERNAL MODULE: ./src/plugins/Wallet/settings.ts
var settings = __webpack_require__(12705);
// EXTERNAL MODULE: ../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/head.js
var head = __webpack_require__(29730);
;// CONCATENATED MODULE: ./src/extension/popups/pages/Wallet/AddDeriveWallet/index.tsx
















const AddDeriveWallet_useStyles = (0,src/* makeStyles */.ZL)()({
    container: {
        padding: '16px 10px',
        backgroundColor: '#ffffff'
    },
    header: {
        display: 'flex',
        justifyContent: 'space-between',
        alignItems: 'center'
    },
    title: {
        fontSize: 12,
        color: '#151818',
        lineHeight: 1.5,
        fontWeight: 500
    },
    path: {
        marginTop: 26,
        marginBottom: 16,
        color: '#1C68F3',
        fontSize: 12,
        lineHeight: '16px',
        fontWeight: 600
    },
    button: {
        fontWeight: 600,
        padding: '10px 0',
        borderRadius: 20,
        fontSize: 14,
        lineHeight: '20px',
        marginTop: 10
    },
    pagination: {
        display: 'flex',
        justifyContent: 'center',
        alignItems: 'center',
        gap: 4
    },
    paginationIcon: {
        border: '1px solid #E4E8F1',
        borderRadius: 4,
        fontSize: 20,
        display: 'flex',
        justifyContent: 'center',
        alignItems: 'center',
        padding: 4
    },
    toolbar: {
        padding: 0
    },
    disabled: {
        opacity: 0.5,
        backgroundColor: '#1C68F3!important',
        color: '#ffffff!important'
    }
});
const AddDeriveWallet = /*#__PURE__*/ (0,react.memo)(()=>{
    const indexes = (0,react.useRef)(new Set());
    const { t  } = (0,utils/* useI18N */.M1)();
    const history = (0,react_router/* useHistory */.k6)();
    const location = (0,react_router/* useLocation */.TH)();
    const { classes  } = AddDeriveWallet_useStyles();
    const wallets = (0,useWallets/* useWallets */.r)(types/* ProviderType.MaskWallet */.lP.MaskWallet);
    const walletName = new URLSearchParams(location.search).get('name');
    const { mnemonic  } = location.state;
    const [page, setPage] = (0,react.useState)(0);
    const { loading , value: dataSource  } = (0,useAsync/* default */.Z)(async ()=>{
        if (mnemonic) {
            const unDeriveWallets = Array.from(indexes.current);
            const derivableAccounts = await messages/* WalletRPC.getDerivableAccounts */.V.getDerivableAccounts(mnemonic, page);
            return derivableAccounts.map((derivedWallet, index)=>{
                const added = !!wallets.find((0,address/* currySameAddress */.DC)(derivedWallet.address));
                const selected = unDeriveWallets.find((item)=>item === index + page * 10
                ) !== undefined;
                return {
                    added,
                    selected,
                    address: derivedWallet.address
                };
            });
        }
        return [];
    }, [
        mnemonic,
        wallets.length,
        page
    ]);
    const onCheck = (0,react.useCallback)(async (checked, index)=>{
        if (checked) {
            indexes.current.add(page * 10 + index);
        } else {
            indexes.current.delete(page * 10 + index);
        }
    }, [
        page
    ]);
    const [{ loading: confirmLoading  }, onConfirm] = (0,useAsyncFn/* default */.Z)(async ()=>{
        const unDeriveWallets = Array.from(indexes.current);
        if (!mnemonic) return;
        if (unDeriveWallets.length) {
            const firstPath = (0,head/* default */.Z)(unDeriveWallets);
            const firstWallet = await messages/* WalletRPC.recoverWalletFromMnemonic */.V.recoverWalletFromMnemonic(`${walletName}${firstPath}`, mnemonic, `${Wallet_src/* HD_PATH_WITHOUT_INDEX_ETHEREUM */.UB}/${firstPath}`);
            const wallets = await Promise.all(unDeriveWallets.slice(1).map(async (pathIndex)=>messages/* WalletRPC.recoverWalletFromMnemonic */.V.recoverWalletFromMnemonic(`${walletName}${pathIndex}`, mnemonic, `${Wallet_src/* HD_PATH_WITHOUT_INDEX_ETHEREUM */.UB}/${pathIndex}`)
            ));
            if (!settings/* currentMaskWalletAccountSettings.value */.T_.value) {
                await messages/* WalletRPC.updateMaskAccount */.V.updateMaskAccount({
                    account: firstWallet
                });
            }
            if (!settings/* currentAccountSettings.value */.aK.value) {
                await messages/* WalletRPC.updateAccount */.V.updateAccount({
                    account: firstWallet,
                    providerType: types/* ProviderType.MaskWallet */.lP.MaskWallet
                });
            }
        }
        history.replace(shared_base_src/* PopupRoutes.Wallet */.mZ.Wallet);
    }, [
        mnemonic,
        walletName,
        wallets.length
    ]);
    return(/*#__PURE__*/ (0,jsx_runtime.jsxs)("div", {
        className: classes.container,
        children: [
            /*#__PURE__*/ (0,jsx_runtime.jsxs)("div", {
                className: classes.header,
                children: [
                    /*#__PURE__*/ (0,jsx_runtime.jsx)(Typography/* default */.Z, {
                        className: classes.title,
                        children: t('plugin_wallet_import_wallet')
                    }),
                    /*#__PURE__*/ (0,jsx_runtime.jsx)(NetworkSelector/* NetworkSelector */.k, {})
                ]
            }),
            /*#__PURE__*/ (0,jsx_runtime.jsx)(Typography/* default */.Z, {
                className: classes.path,
                children: t('popups_wallet_derivation_path', {
                    path: Wallet_src/* HD_PATH_WITHOUT_INDEX_ETHEREUM */.UB
                })
            }),
            /*#__PURE__*/ (0,jsx_runtime.jsx)(TableContainer/* default */.Z, {
                sx: {
                    maxHeight: 320
                },
                children: /*#__PURE__*/ (0,jsx_runtime.jsx)(DeriveWalletTable, {
                    loading: loading,
                    dataSource: dataSource,
                    onCheck: onCheck,
                    confirmLoading: confirmLoading
                })
            }),
            !loading ? /*#__PURE__*/ (0,jsx_runtime.jsx)(TablePagination/* default */.Z, {
                count: -1,
                component: "div",
                onPageChange: ()=>{},
                page: page,
                rowsPerPage: 10,
                rowsPerPageOptions: [
                    10
                ],
                labelDisplayedRows: ()=>null
                ,
                sx: {
                    [`& .${tablePaginationClasses/* default.actions */.Z.actions}`]: {
                        marginLeft: 0
                    }
                },
                backIconButtonProps: {
                    onClick: ()=>setPage((prev)=>prev - 1
                        )
                    ,
                    size: 'small',
                    disabled: page === 0 || confirmLoading
                },
                nextIconButtonProps: {
                    onClick: ()=>setPage((prev)=>prev + 1
                        )
                    ,
                    size: 'small',
                    disabled: confirmLoading
                },
                classes: {
                    root: classes.pagination,
                    toolbar: classes.toolbar
                }
            }) : null,
            /*#__PURE__*/ (0,jsx_runtime.jsx)(LoadingButton/* default */.Z, {
                loading: confirmLoading,
                disabled: confirmLoading || loading,
                variant: "contained",
                classes: {
                    root: classes.button,
                    disabled: classes.disabled
                },
                onClick: onConfirm,
                fullWidth: true,
                children: t('popups_wallet_done')
            })
        ]
    }));
});
/* harmony default export */ const Wallet_AddDeriveWallet = (AddDeriveWallet);


/***/ })

}]);